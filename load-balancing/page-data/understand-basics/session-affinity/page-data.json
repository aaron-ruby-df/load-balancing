{"componentChunkName":"component---src-components-mdx-custom-renderer-js","path":"/understand-basics/session-affinity","result":{"data":{"mdx":{"id":"5f5946c9-cf6b-5818-8b70-cead8487802b","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"order\": 16\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"session-affinity\"\n  }, \"Session affinity\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Cloudflare supports only cookie-based session affinity. Other methods, such as TCP session affinity, are not supported.\")), mdx(\"h2\", {\n    \"id\": \"overview\"\n  }, \"Overview\"), mdx(\"p\", null, \"Loading a website usually requires fetching multiple assets from a web server. Cloudflare Session Affinity minimizes redundant network requests by automatically directing requests from the same client to the same origin web server. Cloudflare sets a cookie on the initial response to the client. Using the cookie in subsequent client requests ensures those requests are sent to the same origin, unless the origin is unavailable.\"), mdx(\"p\", null, \"When enabled, Cloudflare Session Affinity does the following:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"When a client makes its first request\"), \", Cloudflare sets a CFLib cookie on the client. The cookie encodes the origin to which the request will be forwarded.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Subsequent requests by the same client are forwarded to that origin\"), \" for the duration of the cookie and as long as the origin server remains healthy.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"If the cookie expires or the origin server is unhealthy\"), \", Cloudflare sets a new cookie encoding the appropriate failover origin.\")), mdx(\"p\", null, \"All sessions default to 23 hours unless a custom session TTL is specified (in seconds) between 30 minutes and 7 days. A Session Affinity Cookie is required to honor the TTL. The session cookie is secure when \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://support.cloudflare.com/hc/articles/204144518#h_a61bfdef-08dd-40f8-8888-7edd8e40d156\"\n  }, \"Always Use HTTPS\"), \" is enabled. Additionally, HttpOnly is always enabled for the cookie to prevent cross-site scripting attacks.\"), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"enabling-session-affinity-from-the-cloudflare-dashboard\"\n  }, \"Enabling Session Affinity from the Cloudflare dashboard\"), mdx(\"p\", null, \"To enable Session Affinity, use the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Session Affinity\"), \" panel in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Load Balancing\"), \" app.\"), mdx(\"h3\", {\n    \"id\": \"configuring-session-affinity-for-a-new-load-balancer\"\n  }, \"Configuring Session Affinity for a new load balancer\"), mdx(\"p\", null, \"You can enable \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Session Affinity\"), \" when you \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/load-balancing/create-load-balancer-ui\"\n  }, \"create a load balancer\"), \", during the first step of the Create Load Balancer wizard.\"), mdx(\"p\", null, \"To enable session affinity, click the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"By Cloudflare cookie only\"), \" radio button and toggle Session Affinity:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/29007/session-affinity-1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"39.884393063583815%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAAwElEQVQY05VQyw6DIBDk/7+uJw+m8ZnGRwRRsIhStqOkjemhtXOYDJqZ3VlmjBFCcM4hiMh7T6fBpmmq67ppGvj7vg9BUkowNL50XReY74Anaq+XW0Se2DiOaZqWZZllGUQcxxB5nidJAi6KIjB+QYDtPAsjW7WlsLB2GILgYRjeW4UK/oCPXmy2VikNM2zYFlnLslhrv1T1SKAtgjnnlFJw3nfgBFpr8KmDYVRVVZiGh3MP+gdsxgFeWNf12PYnnigWzzHbwjRNAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Configure Session Affinity\",\n    \"title\": \"Configure Session Affinity\",\n    \"src\": \"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/f868f/session-affinity-1.png\",\n    \"srcSet\": [\"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/8f77f/session-affinity-1.png 346w\", \"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/e185b/session-affinity-1.png 691w\", \"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/f868f/session-affinity-1.png 1382w\", \"/load-balancing/static/996910a1d6bc22701ec38e1592b220ad/29007/session-affinity-1.png 1600w\"],\n    \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Client IP fallback\"), \" option behaves the same as the cookie option except the client IP address is used as a fallback when no session affinity cookie is provided.\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Session Affinity with Client IP fallback is not supported for load balancers in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/load-balancing/understand-basics/proxy-modes\"\n  }, \"DNS-only mode (gray cloud)\"), \".\")), mdx(\"h3\", {\n    \"id\": \"configuring-session-affinity-for-an-existing-load-balancer\"\n  }, \"Configuring Session Affinity for an existing load balancer\"), mdx(\"p\", null, \"You can configure session affinity for an existing load balancer from the Load Balancing dashboard. Click the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Edit\"), \" button associated with the load balancer to open the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Edit Load Balancer\"), \" view and access the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Session Affinity\"), \" option.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"728px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/load-balancing/static/2737e0bacb4735247a40234d386e38e2/cecac/session-affinity-2.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"36.70520231213873%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQY032Rz0rDQBDG84BeBS/eBBHvvoAvUFQQPNhTD32CakHBClpbq9Zi07SBNmmy2WiySTbZZDfJblwjiie/w8fMwG+YP0pZlkmSxHGcpmn1V0L8BLyOxXzt3U5Bf+bcz5w71XG9QMmyzLZtAACEkFL6i4kEC2hVKZEprwvNK23rZLDffN5rPm2fDt+WUJGA53lBECCEwjCMoghj/O343cXqhLwMyEKtquK8DzaORwet8c7Z4+ZRf7pyFUJS3/clLF3yfq2vdgjRPGecUxym6ivrdcbtdufi4VrzLyegO1pZ8EOB0DGNpRxb13XpEjMMY65pK8Nw5CYAmGvLQQFwoHnTjVuN8HA3GvY85NnWWmEso1lYFGXOWL2vyIuCUZpRlrJSVgghMcaclyIwzXgy7zWShW4C4EKoyGtzLngt8b8KJsqC1x+QfTOWfwJ0bH1Sr2TnQgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Load balancing card Edit option\",\n    \"title\": \"Load balancing card Edit option\",\n    \"src\": \"/load-balancing/static/2737e0bacb4735247a40234d386e38e2/cecac/session-affinity-2.png\",\n    \"srcSet\": [\"/load-balancing/static/2737e0bacb4735247a40234d386e38e2/8f77f/session-affinity-2.png 346w\", \"/load-balancing/static/2737e0bacb4735247a40234d386e38e2/e185b/session-affinity-2.png 691w\", \"/load-balancing/static/2737e0bacb4735247a40234d386e38e2/cecac/session-affinity-2.png 728w\"],\n    \"sizes\": \"(max-width: 728px) 100vw, 728px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"origin-drain\"\n  }, \"Origin Drain\"), mdx(\"p\", null, \"Drain or remove all traffic from an origin without affecting any active customers using Origin Drain. Enable Origin Drain by entering a value in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Origin drain duration TTL\"), \" field, after enabling Session Affinity. \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Origin drain duration TTL\"), \" is the time (in seconds) it takes to drain all active connections. Traffic drains from any disabled origin or from all origins within a disabled pool.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1002px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/load-balancing/static/0262afb8ef8f560b01657e90c996b35c/d69c4/session-affinity-3.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.13294797687862%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABAklEQVQoz5WS626EIBCFff/Xaf3jozQ13azXxbugAl5OGTYabW3jkpzMQODkmxmcJElQliW01lBKbVFKucV9vj9bRW94J+C6Lhzf9xEEAaIospEUhiHSND0ojuPDnjEGgqFzpRWihuHNfYdTFAWyLLOqqgp1Xf8i/km/nq37eZ6tPM97GuZ5Dopd16HveyzLglfXZkg0RNc0je0HGY7jaC+R8RUdDHNDxrlAyzm4EGja1hpfMVzvHA0zhqrMIYcOaugxjfpymaeEj8BHev9EFn0huX2gZDGE6aUwtNRTbsgpJ+3zaZrOCanUYTD/iyZmJOVzivTgP/1ZMvVrHcKr66zkb0/GBFvtkB+MAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Session affinity configuration with origin drain\",\n    \"title\": \"Session affinity configuration with origin drain\",\n    \"src\": \"/load-balancing/static/0262afb8ef8f560b01657e90c996b35c/d69c4/session-affinity-3.png\",\n    \"srcSet\": [\"/load-balancing/static/0262afb8ef8f560b01657e90c996b35c/8f77f/session-affinity-3.png 346w\", \"/load-balancing/static/0262afb8ef8f560b01657e90c996b35c/e185b/session-affinity-3.png 691w\", \"/load-balancing/static/0262afb8ef8f560b01657e90c996b35c/d69c4/session-affinity-3.png 1002w\"],\n    \"sizes\": \"(max-width: 1002px) 100vw, 1002px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"To check the status of a disabled origin\\u2019s drain, use the added \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Drain Time\"), \" column in the Manage Load Balancer table. \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Drain Time\"), \" shows the time remaining for a drain in progress. You can edit the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Origin drain duration TTL\"), \" field value while an origin drains. Entering a value shorter than the remaining TTL for drains in progress servers current connections to those origins.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"802px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/load-balancing/static/936eae73dbc8677c86208a6e1ab8fbaa/5a6dd/session-affinity-4.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"34.39306358381503%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABPUlEQVQoz02RiY6DMAxE+f8PXGmFoARoCrkD5S6dtdMiLdJoYsdxXkymWolRG8zzDK0UnHNYlgXjOKZYGwMbYtofhgFd18G6gNFIPJsfNE6j6hp4P0A7j+xxlwjUhBuVZQkpJWKMMNSoKAoUlOv6HiEEqvHQWif3zsIbBesdXcDyyTOvNNY4YN02WGuxriuO40jufSDR4TjiORP1tCAvG0SiH+hSrjmPHce+4djW5Nm9aeHoydyMCdu2TTRMyHFVVWnNOaav6waBqESZ41bkMKqDetxR5L/oZYssdgq7jzjfb2xEeX3neWKanmmeoL0rl5bvF8YhfJ//mbm1Dusy0QyJMBqbCEUlEkV6JonJOH/Fl5iWqWQj8Ghr6F4m7ymX3USNnIY/TxOEEOlP8mxYTMy64v/a9h37V1zz8R1/mXYTeGb1d7EAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Manage Load Balancer table with draining in progress\",\n    \"title\": \"Manage Load Balancer table with draining in progress\",\n    \"src\": \"/load-balancing/static/936eae73dbc8677c86208a6e1ab8fbaa/5a6dd/session-affinity-4.png\",\n    \"srcSet\": [\"/load-balancing/static/936eae73dbc8677c86208a6e1ab8fbaa/8f77f/session-affinity-4.png 346w\", \"/load-balancing/static/936eae73dbc8677c86208a6e1ab8fbaa/e185b/session-affinity-4.png 691w\", \"/load-balancing/static/936eae73dbc8677c86208a6e1ab8fbaa/5a6dd/session-affinity-4.png 802w\"],\n    \"sizes\": \"(max-width: 802px) 100vw, 802px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"When a drain is \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Complete\"), \", there are no longer any connections to that origin.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"802px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/load-balancing/static/eb4baac4e2930d2acef99a53691ed47b/5a6dd/session-affinity-5.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"34.39306358381503%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz12R2XKDMAxF+f8fbCclBMJiMN5ZjIHmVjbNQ8uMRsv1SEciMwOHNxb7cUBrjWmacJ4nvN9gKDekuWVN+rqukELAzSu8Ygj8gcZK9IqnmpsXZKztoKWClBJFUaBtW1hrwTlHnue43+8YKDbGpDd8HKFokJbkxwGjUhBUF1IlywwfsbkJWwhQJAbyB9Fs20bEJjXSdsJCxJHi69GQn+GsQfArju2yM3gce0DWNQ1NEml6pGkoj01GIonEZVkmgniOSF9HneiK2wee5QNWK/Rdg/z2Cd5WyFzPsWuL79crUb2/eMeZSLz3f2pXEOi+Cm6aUxr2HaOQCItD1tcNLCWRsKoqMMYSYVxf0A+IPq0d76av2CiBgWg4q2HlADl0YHUJ3j2RldQkp9WWZUnrOecSabR4z3f836J26R6B8v03/wHV2xSwHwrI5QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Manage Load Balancer table with draining complete\",\n    \"title\": \"Manage Load Balancer table with draining complete\",\n    \"src\": \"/load-balancing/static/eb4baac4e2930d2acef99a53691ed47b/5a6dd/session-affinity-5.png\",\n    \"srcSet\": [\"/load-balancing/static/eb4baac4e2930d2acef99a53691ed47b/8f77f/session-affinity-5.png 346w\", \"/load-balancing/static/eb4baac4e2930d2acef99a53691ed47b/e185b/session-affinity-5.png 691w\", \"/load-balancing/static/eb4baac4e2930d2acef99a53691ed47b/5a6dd/session-affinity-5.png 802w\"],\n    \"sizes\": \"(max-width: 802px) 100vw, 802px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"enabling-session-affinity-via-the-cloudflare-api\"\n  }, \"Enabling Session Affinity via the Cloudflare API\"), mdx(\"p\", null, \"Session affinity is a property of load balancers. Use the following endpoint to configure Session Affinity (see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/load-balancing/create-load-balancer-api/\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Create a load balancer with the API\")), \"):\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-txt\"\n  }, \"zones/:identifier/load_balancers\\n\")), mdx(\"p\", null, \"Set the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"session_affinity\"), \" parameter to configure the feature. The default value is an empty string, which indicates that Session Affinity is disabled. To enable it, use the value \\u201Ccookie\\u201D in your request.\"), mdx(\"p\", null, \"Set the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"session_affinity_ttl\"), \" parameter to configure the duration of session affinity cookies. Values are in seconds and must be in the range 1800\\u2013604800 (30 minutes to seven days). Unless \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"session_affinity\"), \" is explicitly set, the default value of 23 hours is used. This parameter is ignored when Session Affinity is disabled.\"), mdx(\"p\", null, \"For a detailed description of the limitations and values available for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"session-affinity\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"session_affinity_ttl\"), \", see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/load-balancing/understand-basics/load-balancers/#properties\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Load balancers\")), \".\"), mdx(\"h3\", {\n    \"id\": \"configuring-session-affinity-for-a-new-load-balancer-1\"\n  }, \"Configuring Session Affinity for a new load balancer\"), mdx(\"p\", null, \"You can configure session affinity as part of your request to the Create Load Balancer command.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Request example (\", mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"curl\"), \")\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"curl -X POST \\\"https://api.cloudflare.com/client/v4/zones/699d98642c564d2e855e9661899b7252/load_balancers\\\" \\\\\\n     -H \\\"X-Auth-Email: user@example.com\\\" \\\\\\n     -H \\\"X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda41\\\" \\\\\\n     -H \\\"Content-Type: application/json\\\" \\\\\\n     --data '   \\\"description\\\":\\\"Load Balancer for www.example.com\\\",\\n   \\\"name\\\":\\\"www.example.com\\\",\\n   \\\"ttl\\\":30,\\n   \\\"fallback_pool\\\":\\\"17b5962d775c646f3f9725cbc7a53df4\\\",\\n   \\\"default_pools\\\":[\\n      \\\"17b5962d775c646f3f9725cbc7a53df4\\\",\\n      \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\",\\n      \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n   ],\\n   \\\"region_pools\\\":{\\n      \\\"WNAM\\\":[\\n         \\\"de90f38ced07c2e2f4df50b1f61d4194\\\",\\n         \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"ENAM\\\":[\\n         \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n      ]\\n   },\\n   \\\"pop_pools\\\":{\\n      \\\"LAX\\\":[\\n         \\\"de90f38ced07c2e2f4df50b1f61d4194\\\",\\n         \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"LHR\\\":[\\n         \\\"abd90f38ced07c2e2f4df50b1f61d4194\\\",\\n         \\\"f9138c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"SJC\\\":[\\n         \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n      ]\\n   },\\n   \\\"proxied\\\":true,\\n   \\\"steering_policy\\\":\\\"dynamic_latency\\\",\\n   \\\"session_affinity\\\":\\\"cookie\\\",\\n   \\\"session_affinity_ttl\\\":5000\\n}''\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Response\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": [],\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"699d98642c564d2e855e9661899b7252\\\",\\n    \\\"created_on\\\": \\\"2014-01-01T05:20:00.12345Z\\\",\\n    \\\"modified_on\\\": \\\"2014-01-01T05:20:00.12345Z\\\",\\n    \\\"description\\\": \\\"Load Balancer for www.example.com\\\",\\n    \\\"name\\\": \\\"www.example.com\\\",\\n    \\\"enabled\\\": true,\\n    \\\"ttl\\\": 30,\\n    \\\"fallback_pool\\\": \\\"17b5962d775c646f3f9725cbc7a53df4\\\",\\n    \\\"default_pools\\\": [\\n      \\\"17b5962d775c646f3f9725cbc7a53df4\\\",\\n      \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\",\\n      \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n    ],\\n    \\\"region_pools\\\": {\\n      \\\"WNAM\\\": [\\n        \\\"de90f38ced07c2e2f4df50b1f61d4194\\\",\\n        \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"ENAM\\\": [\\n        \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n      ]\\n    },\\n    \\\"pop_pools\\\": {\\n      \\\"LAX\\\": [\\n        \\\"de90f38ced07c2e2f4df50b1f61d4194\\\",\\n        \\\"9290f38c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"LHR\\\": [\\n        \\\"abd90f38ced07c2e2f4df50b1f61d4194\\\",\\n        \\\"f9138c5d07c2e2f4df57b1f61d4196\\\"\\n      ],\\n      \\\"SJC\\\": [\\n        \\\"00920f38ce07c2e2f4df50b1f61d4194\\\"\\n      ]\\n    },\\n    \\\"proxied\\\": true,\\n    \\\"steering_policy\\\": \\\"dynamic_latency\\\",\\n    \\\"session_affinity\\\": \\\"cookie\\\",\\n    \\\"session_affinity_ttl\\\": 5000\\n  }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"configuring-session-affinity-for-an-existing-load-balancer-1\"\n  }, \"Configuring Session Affinity for an existing load balancer\"), mdx(\"p\", null, \"Use the Update Load Balancer endpoint to configure session affinity for an existing load balancer:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-txt\"\n  }, \"PUT zones/:identifier/load_balancers/:identifier\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Request example (curl)\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"curl -X PUT \\\"https://api.cloudflare.com/client/v4/zones/699d98642c564d2e855e9661899b7252/load_balancers\\\" \\\\\\n     -H \\\"X-Auth-Email: user@example.com\\\" \\\\\\n     -H \\\"X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda41\\\" \\\\\\n     -H \\\"Content-Type: application/json\\\" \\\\\\n     --data '   \\\"description\\\":\\\"Load Balancer for www.example.com\\\",\\n   \\\"name\\\":\\\"www.example.com\\\",\\n   \\\"Enabled\\\":true,\\n    \\\"proxied\\\":true,\\n   \\\"steering_policy\\\":\\\"dynamic_latency\\\",\\n   \\\"session_affinity\\\":\\\"cookie\\\",\\n   \\\"session_affinity_ttl\\\":5000\\n}''\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Response\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": [],\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"699d98642c564d2e855e9661899b7252\\\",\\n    \\\"created_on\\\": \\\"2014-01-01T05:20:00.12345Z\\\",\\n    \\\"modified_on\\\": \\\"2014-01-01T05:20:00.12345Z\\\",\\n    \\\"description\\\": \\\"Load Balancer for www.example.com\\\",\\n    \\\"name\\\": \\\"www.example.com\\\",\\n    \\\"enabled\\\": true,\\n    \\\"proxied\\\": true,\\n    \\\"steering_policy\\\": \\\"dynamic_latency\\\",\\n    \\\"session_affinity\\\": \\\"cookie\\\",\\n    \\\"session_affinity_ttl\\\": 5000\\n  }\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":null,"updated":null}}},"pageContext":{"id":"5f5946c9-cf6b-5818-8b70-cead8487802b","fields":{"slug":"/understand-basics/session-affinity"},"frontmatter":{"title":"","type":null,"order":16,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Session affinity","depth":1}],"tableOfContents":{"items":[{"url":"#session-affinity","title":"Session affinity","items":[{"url":"#overview","title":"Overview"},{"url":"#enabling-session-affinity-from-the-cloudflare-dashboard","title":"Enabling Session Affinity from the Cloudflare dashboard","items":[{"url":"#configuring-session-affinity-for-a-new-load-balancer","title":"Configuring Session Affinity for a new load balancer"},{"url":"#configuring-session-affinity-for-an-existing-load-balancer","title":"Configuring Session Affinity for an existing load balancer"},{"url":"#origin-drain","title":"Origin Drain"}]},{"url":"#enabling-session-affinity-via-the-cloudflare-api","title":"Enabling Session Affinity via the Cloudflare API","items":[{"url":"#configuring-session-affinity-for-a-new-load-balancer-1","title":"Configuring Session Affinity for a new load balancer"},{"url":"#configuring-session-affinity-for-an-existing-load-balancer-1","title":"Configuring Session Affinity for an existing load balancer"}]}]}]},"parent":{"modifiedTime":"2021-02-18","relativePath":"understand-basics/session-affinity.md"}}},"staticQueryHashes":["1302537747","2814688963","32046230","338033027","811020565"]}